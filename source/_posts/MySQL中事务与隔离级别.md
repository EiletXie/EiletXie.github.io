---
title: MySQL中事务与隔离级别
date: 2019-10-07 09:00:04
tags:
- MySQL
- 索引
categories:
- 数据库
toc: true

---



## 事务以及隔离性级别

### 事务特性 ACID

**1. 原子性（Atomicity）**

事务被视为不可分割的最小单元，事务的所有操作要么全部提交成功，要么全部失败回滚。

回滚可以用回滚日志来实现，回滚日志记录着事务所执行的修改操作，在回滚时反向执行这些修改操作即可。

**2. 一致性（Consistency）**

数据库在事务执行前后都保持一致性状态。在一致性状态下，所有事务对一个数据的读取结果都是相同的。

**3. 隔离性（Isolation）**

一个事务所做的修改在最终提交以前，对其它事务是不可见的。

**4. 持久性（Durability）**

一旦事务提交，则其所做的修改将会永远保存到数据库中。即使系统发生崩溃，事务执行的结果也不能丢失。

<!--more--><br/>

### 并发一致性产生的问题

​	修改无效： A 和 B 两个事务都对一个数据进行修改，A 先修改，B 随后修改，B 的修改覆盖了 A 的修改

​	脏读：  A事务修改了值，B事务查询到该值，当A事务回滚修改时，B读的就是脏数据

​	不可重复读 :  A事务读取了数据，如果B事务修改该数据，则A再次读取时数值不一致

​	幻读 ： A事务查询某范围的数量，B事务插入一条数据，范围数量发生了改变（即使事务隔离性，操作不可见，但物理数据行号会改变，操作检测的是物理行号）

<br/>

### 隔离级别

READ UNCOMMITED(未提交读): 事务未提交，但其他事务可以查看到该事务的修改，该级别及以上可避免修改无效

READ COMMITTED(提交读）： 事务未提交前对其他事务是不可见的。该级别及以上可避免脏读（ORACLE默认级别）

REPEATABLE READ(可重复读）: 事务与事务之间的操作相互隔离，互不影响，（MYSQL默认级别）

SERIALIZE(可串行化）： 避免了幻读，执行顺序化，无并发可言

<br/>

{% asset_img isolation.jpg isolation%}



**mysql设置事务隔离级别(设置未提交读）**

*set session transaction isolation level read uncommitted;* 

<br/>

### AUTOCOMMIT

MySQL 默认采用自动提交模式。也就是说，如果不显式使用START TRANSACTION语句来开始一个事务，那么每个查询都会被当做一个事务自动提交